import { const ADMIN_PASSWORD = "sohan123";
  getDatabase, ref, push, onValue, remove, update 
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const db = getDatabase();
const epRef = ref(db, "episodes");

window.addEpisode = function() {
  const number = document.getElementById("epNumber").value;
  const title = document.getElementById("epTitle").value;
  const video = document.getElementById("epVideo").value;

  push(epRef, {
    number: number,
    title: title,
    video: video
  });

  alert("Episode Added!");
}

onValue(epRef, (snapshot) => {
  const data = snapshot.val();
  const container = document.getElementById("episodeList");
  container.innerHTML = "";

  for (let id in data) {
    container.innerHTML += `
      <div style="margin:10px; padding:10px; background:#222;">
        <b>EP ${data[id].number}</b> - ${data[id].title}
        <br>
        <button onclick="editEpisode('${id}')">Edit</button>
        <button onclick="deleteEpisode('${id}')">Delete</button>
      </div>
    `;
  }
});

window.deleteEpisode = function(id){
  remove(ref(db, "episodes/" + id));
}

window.editEpisode = function(id){
  const newTitle = prompt("New Title:");
  const newNumber = prompt("New Episode Number:");
  const newVideo = prompt("New Video Link:");

  update(ref(db, "episodes/" + id), {
    title: newTitle,
    number: newNumber,
    video: newVideo
  });
}
